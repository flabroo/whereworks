<div class="container">

  <div class="booking-card">
    <div class="booking-status">
      <% if current_user == @booking.user %>
        <% if @booking.status == 'Pending' %>
          <h2>Your booking is <%= @booking.status.downcase %> for <%= @booking.listing.name %>.</h2>
        <% else %>
          <h2>Your booking is <%= @booking.status.downcase %> for <%= @booking.listing.name %>.</h2>
        <% end %>
      <% else %>
        <h2>You have a <%= @booking.status.downcase %> booking for <%= @booking.listing.name.capitalize %>.</h2>
      <% end %>
    </div>
    <div class="booking-details">
      <p>Date: <%= @booking.date %></p>
      <p>Time: <%= @booking.start_time.strftime('%H:%M') %> - <%= @booking.end_time.strftime('%H:%M') %></p>
      <p>Booking Type: <%= @booking.listing.booking_type %></p>
      <p>Quantity: <%= @booking.quantity %></p>
      <p>Price: <%= @booking.listing.price %></p>
    </div>
    <div class="booking-confirmations">
      <% if @booking.listing.user == current_user %>
        <%= link_to "Confirm", confirm_booking_path(@booking, status: "Active"), method: :patch, class: "btn btn-submit"%>
        <%= link_to "Reject", cancel_booking_path(@booking, status: "Cancelled"), method: :patch, class: "btn btn-submit"%>
          <% if @booking.listing.bookings.where(date: @booking.date, status: "Active").present? %>
            <h3>Here are other bookings for this listing today:</h3>
            <% @booking.listing.bookings.where(date: @booking.date, status: "Active").each do |booking| %>
              <p><%= booking.start_time %> - <%= booking.end_time %></p>
              <p>Booked by <%= booking.user.first_name.capitalize %> <%= booking.user.last_name.capitalize %></p>
            <% end %>
          <% end %>
        <% else %>
          <%= link_to "Cancel", cancel_booking_path(@booking, status: "Cancelled"), method: :patch, class: "btn btn-submit"%>
        <% end %>
    </div>
  </div>

  <div class="user-reviews-wrap">
    <div class="profile-card">
      <div class="profile-pic">
       <% if current_user.photo.attached? %>
         <%=  cl_image_tag current_user.photo.key, width: 100, height: 100, crop: :thumb, gravity: :face %>
       <% else %>
         <%= image_tag "defaultavatar.png" %>
      <% end %>
      </div>
      <div class="name">
      <h1 class="name-text"><%= @booking.user.first_name.capitalize %> <%= @booking.user.last_name.capitalize %></h1>
    </div>
    <div class="user-reviews">
    </div>
  </div>

</div>
